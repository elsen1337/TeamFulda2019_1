<?phpclass AppartImage {    public static $dbvar='msdb';    public static $formFields=array('wohn_id'=>'selection','rdr'=>'number','alt'=>'text');        public static $uploadBaseDir='images';    public static $dirThumb='thumb';    public static $dirOrg='normal';        const MAX_IMAGE_NUM=10;    const MAX_IMAGE_SIZE_KB=1024 * 4;    const MAX_IMAGE_WIDTH=150;    const MAX_IMAGE_HEIGHT=150;    public static function addImage($prp) {            $sql='INSERT INTO w_image ('.implode(',',array_keys($prp)).') VALUES ("'.implode('","',($prp)).'")';        $mrs=$GLOBALS[self::$dbvar]->query($sql);                return $GLOBALS[self::$dbvar]->insert_id;            }            public static function uploadImage($bildUpload,$postParam=array()) {            foreach ($bildUpload['error'] as $bid => $val) {                        if ($val > 0) {continue;}            if ($bildUpload['size'][$bid] > self::MAX_IMAGE_SIZE_KB * 1024 || $bildUpload['size'][$bid] == 0) {continue;}            if (strpos($bildUpload['type'][$bid],'image') === false) {continue;}                        # stringNormalize::normalizeURL File            $oldFileName = $bildUpload['name'][$bid];            $pathInfoOld=pathinfo($oldFileName);                      // $r=trim(preg_replace('/(\d+)/i', '-$1-', $r),'-');            // $r=str_replace('.', '', $r); $r=preg_replace('/\-+/i', '-', $r);            $tmpUploadFileName=$bildUpload['tmp_name'][$bid];                                    $bsqlid=is_int($bid)===false ? AppartImage::addImage(array_intersect_key($postParam,AppartImage::$formFields)) : $bid;            var_dump($bsqlid);            $newFileName = str_pad($bsqlid, 5, "0", STR_PAD_LEFT).'-'.stringNormalize::normalizeURL($pathInfoOld['filename']).'.'.$pathInfoOld['extension'];            $targetFile = implode('/',array(self::$dirOrg, $newFileName));                        move_uploaded_file($tmpUploadFileName,$targetFile);            file_put_contents(self::$dirThumb .'/'.substr($newFileName,0,(false==$p=strrpos($newFileName,'.')) ? strlen($newFileName) : $p).'.jpg', image_get_thumb_file ($targetFile, 100, 100, 65));                    $GLOBALS[self::$dbvar]->query('UPDATE w_image SET bild = "'.$newFileName.'" WHERE bild_id='.$bsqlid);                    }            }                public static function removeImage($bid) {            }        public static function formThumbFileName($img) {        $pathInfo=pathinfo($img);        return $pathInfo['filename'].'.jpg';    }        public static function formThumbFilePath($img) {        return implode('/',array(self::$uploadBaseDir,self::$dirThumb,self::formThumbFileName($img) ));    }        public static function formNormalFilePath($img) {        return implode('/',array(self::$uploadBaseDir,self::$dirOrg,$img ));    }        public static function formNormalizedFileName($img) {            }        public static function getMaxPictNum() {        return self::MAX_IMAGE_NUM;    }    }?>